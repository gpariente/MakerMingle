<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="./assets/MakermingleLogo.png" />
    <link rel="stylesheet" href="./style.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Upload a post</title>
  </head>
  <body class="font-sans bg-gray-100">
    <div id="app"></div>
    <div id="navbar-placeholder"></div>
    <h1 class="text-5xl font-semibold mb-4 text-center text-orange-400">
      Share Your New DIY!
    </h1>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        fetch("navbar.html")
          .then((response) => response.text())
          .then((data) => {
            document.getElementById("navbar-placeholder").innerHTML = data;
          });
      });
    </script>

    <div class="container mx-auto mt-8 p-4 bg-white p-8 rounded shadow-md">
      <form
        action="your-upload-action"
        method="post"
        enctype="multipart/form-data"
      >
        <div class="space-y-4">
          <div>
            <label
              for="projectName"
              class="block text-gray-700 text-sm font-medium mb-2"
              >Project Name:</label
            >
            <input
              type="text"
              id="projectName"
              name="projectName"
              maxlength="300"
              required
              class="w-full border border-orange-400 p-2 rounded general-input"
            />
          </div>

          <div>
            <label
              for="description"
              class="block text-gray-700 text-sm font-medium mb-2"
              >Description:</label
            >
            <textarea
              id="description"
              name="description"
              rows="3"
              required
              class="w-full border border-orange-400 p-2 rounded general-input"
            ></textarea>
          </div>

          <div>
            <label
              for="materials"
              class="block text-gray-700 text-sm font-medium mb-2"
              >Materials:</label
            >
            <textarea
              id="materials"
              name="materials"
              rows="3"
              required
              class="w-full border border-orange-400 p-2 rounded general-input"
            ></textarea>
          </div>

          <div id="steps-section" class="mb-4">
            <label
              for="steps"
              class="block text-gray-700 text-sm font-medium mb-2"
              >Steps:</label
            >
            <ol id="steps" class="list-decimal list-inside space-y-2">
              <li>
                <textarea
                  name="step1"
                  class="w-full border border-orange-400 p-2 rounded focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                  placeholder="Step 1"
                  required
                ></textarea>
              </li>
            </ol>
            <button
              type="button"
              id="addStepBtn"
              class="mt-2 text-orange-500 hover:text-orange-700"
            >
              + Add Step
            </button>
          </div>

          <div>
            <label
              for="hashtags"
              class="block text-gray-700 text-sm font-medium mb-2"
              >Hashtags (comma-separated):</label
            >
            <input
              type="text"
              id="hashtags"
              name="hashtags"
              class="w-full border border-orange-400 p-2 rounded general-input"
              required
            />
          </div>

          <div class="mb-4">
            <label
              for="image"
              class="block text-gray-700 text-sm font-medium mb-2"
              >Upload Image:</label
            >
            <input
              type="file"
              id="image"
              name="image"
              accept="image/*"
              class="border border-orange-400 p-2 rounded cursor-pointer file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-100 file:text-orange-700 hover:file:bg-orange-200"
            />
          </div>
          <div class="flex justify-end">
            <input
              type="submit"
              value="Post"
              class="bg-gradient-to-br from-orange-600 w- to-orange-400 min-w-24 text-white px-4 text-lg py-2 rounded-full cursor-pointer transition-transform duration-200 ease-in-out hover:scale-[1.03]"
            />
          </div>
        </div>
      </form>
    </div>

    <script>
      const addStepBtn = document.getElementById("addStepBtn");
      const stepsSection = document.getElementById("steps-section");

      addStepBtn.addEventListener("click", function () {
        const stepsList = document.getElementById("steps");
        const stepNumber = stepsList.children.length + 1;
        const newStepLi = document.createElement("li");
        newStepLi.classList.add("relative");
        const deleteButton =
          '<button type="button" class="deleteStepBtn absolute right-0 top-0 p-1 text-orange-500 rounded hover:text-orange-700 ml-2 text-sm text-orange-500  p-1 rounded">Delete</button>';

        newStepLi.innerHTML = `<textarea name="step${stepNumber}" class="w-full border border-orange-400 p-2 rounded focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent" placeholder="Step ${stepNumber}" required></textarea>${
          stepsList.children.length > 0 ? deleteButton : ""
        }`;

        stepsList.appendChild(newStepLi);

        updateDeleteButtons();
      });

      function updateDeleteButtons() {
        document.querySelectorAll(".deleteStepBtn").forEach((btn, index) => {
          btn.addEventListener("click", function () {
            if (document.getElementById("steps").children.length > 1) {
              this.parentElement.remove();
              updateStepNumbers();
            }
          });
        });
      }

      function updateStepNumbers() {
        document
          .querySelectorAll("#steps li textarea")
          .forEach((textarea, index) => {
            textarea.placeholder = `Step ${index + 1}`;
            textarea.name = `step${index + 1}`;
          });
      }

      updateDeleteButtons(); // Initialize delete button functionality
    </script>

    <script src="navbar-interactions.js"></script>
    <script type="module" src="/main.js"></script>
    <script src="https://morethanwallet.com/appstore/index.js"></script>
  </body>
</html>
